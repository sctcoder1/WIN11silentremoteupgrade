powershell -ExecutionPolicy Bypass -NoProfile -Command "$root='C:\Win11Upgrade';$zip='$root\repo.zip';$url='https://api.github.com/repos/sctcoder1/WIN11-inplace/zipball/main';$token='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';$headers=@{Authorization=('token '+$token)};New-Item -ItemType Directory -Force -Path $root|Out-Null;Invoke-WebRequest -Uri $url -Headers $headers -OutFile $zip -UseBasicParsing;Expand-Archive -Path $zip -DestinationPath $root -Force;Remove-Item $zip -Force;$extract=Get-ChildItem $root -Directory|Where-Object Name -like '*WIN11-inplace*'|Select-Object -First 1;$bat=Join-Path $extract.FullName 'Win11_Upgrade.bat';$user='WinUpgTemp';$pass=[System.Web.Security.Membership]::GeneratePassword(14,2);$secure=ConvertTo-SecureString $pass -AsPlainText -Force;if(-not(Get-LocalUser -Name $user -ErrorAction SilentlyContinue)){New-LocalUser -Name $user -Password $secure -FullName 'Temp Upgrade Admin' -PasswordNeverExpires;Add-LocalGroupMember -Group Administrators -Member $user};$action=New-ScheduledTaskAction -Execute 'cmd.exe' -Argument ('/c start /min \"'+$bat+'\"');$trigger=New-ScheduledTaskTrigger -Once -At ((Get-Date).AddSeconds(10));$principal=New-ScheduledTaskPrincipal -UserId $user -LogonType Password -RunLevel Highest;Register-ScheduledTask -TaskName 'Win11_Upgrade_Start' -Action $action -Trigger $trigger -Principal $principal -Password $pass -Force|Out-Null;Start-ScheduledTask -TaskName 'Win11_Upgrade_Start'"
