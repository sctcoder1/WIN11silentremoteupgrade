powershell -ExecutionPolicy Bypass -NoProfile -Command "$root='C:\Win11Upgrade';$bat='$root\RepoHandler.bat';$ps1='$root\RepoHandler.ps1';$urlbat='https://raw.githubusercontent.com/sctcoder1/WIN11-inplace/main/RepoHandler.bat';$urlps1='https://raw.githubusercontent.com/sctcoder1/WIN11-inplace/main/RepoHandler.ps1';$token='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';$headers=@{Authorization=('token '+$token)};New-Item -ItemType Directory -Force -Path $root|Out-Null;$user='WinUpgTemp';$pass=[System.Web.Security.Membership]::GeneratePassword(14,2);$secure=ConvertTo-SecureString $pass -AsPlainText -Force;if(-not(Get-LocalUser -Name $user -ErrorAction SilentlyContinue)){New-LocalUser -Name $user -Password $secure -FullName 'Temp Upgrade Admin' -PasswordNeverExpires;Add-LocalGroupMember -Group Administrators -Member $user};Invoke-WebRequest -Uri $urlbat -Headers $headers -OutFile $bat -UseBasicParsing;Invoke-WebRequest -Uri $urlps1 -Headers $headers -OutFile $ps1 -UseBasicParsing;$act=New-ScheduledTaskAction -Execute 'cmd.exe' -Argument ('/c start /min \"'+$bat+'\"');$trg=New-ScheduledTaskTrigger -Once -At ((Get-Date).AddSeconds(10));$prn=New-ScheduledTaskPrincipal -UserId $user -LogonType Password -RunLevel Highest;Register-ScheduledTask -TaskName 'Win11_RepoHandler' -Action $act -Trigger $trg -Principal $prn -Password $pass -Force|Out-Null;Start-ScheduledTask -TaskName 'Win11_RepoHandler'"
